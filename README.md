# 学习专注度监测系统

本项目是一个基于 **微信小程序 + Flask 后端 + 树莓派图像识别** 的学习专注度统计与分析系统。通过摄像头采集用户行为数据，结合 OpenCV 图像识别算法判断用户的专注状态，并通过微信小程序展示专注时长与分心情况，帮助用户提升学习效率。

------

## 📁 项目结构
.
├── frontend/         # 微信小程序前端代码

├── backend/          # Flask 后端服务 + 图像识别脚本

│   ├── app.py        # Flask 主程序

│   ├── test.py       # 图像识别核心脚本（树莓派运行）

│   └── best_phone.onnx  # ONNX 模型文件（未包含在提交中）

└── README.md         # 本文件

------

## 🧩 功能模块说明

### 1. 微信小程序（frontend）

- 页面组成：
  - 首页：显示当前低头时间、次数、评分等实时数据
  - 历史记录：查看过去一段时间内的专注情况
  - 报告页：展示某天的详细检测结果
- 登录机制：使用微信授权登录，获取 Token 访问后端 API
- 接口依赖：所有请求指向本地或远程部署的 Flask 后端服务

------

### 2. Flask 后端服务（backend/app.py）

- 提供 RESTful API 接口：
  - `/auth`：用户登录，返回 Token
  - `/refresh`：刷新 Token
  - `/receive_data`：接收树莓派发送的传感器数据
  - `/data`：返回当前专注度数据（需登录）
- 使用 SQLAlchemy 将数据存储到 SQLite 数据库中

------

### 3. 图像识别脚本（backend/opencv-test.py）

- 使用 Mediapipe 和 OpenCV 检测用户的头部姿态与手机使用行为
- 判断标准：
  - 头部是否低于肩膀（低头判断）
  - 是否存在手机靠近头部（ONNX 模型检测）
- 检测结果会通过 HTTP POST 发送到 `/receive_data` 接口

------

## 🛠️ 安装与运行

### 前提条件

- Python 3.x
- 微信开发者工具
- 树莓派 + 摄像头（用于图像识别模块）

服务默认监听在 `0.0.0.0:5000`
